<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —à–∫–æ–ª–∞</title>
  <style>
    :root {
      --bg: #0f1724;
      --card: #0b1220;
      --accent: #06b6d4;
      --muted: #94a3b8;
      --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,#071029 0%,#091426 100%);color:#e6eef6}
    .screen{width:100%;height:100%;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}
    .slides{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;transition:transform .5s ease}
    .slide{min-width:100%;height:100%;padding:40px;display:flex;flex-direction:column;justify-content:space-between}
    .slide-inner{background:var(--glass);backdrop-filter:blur(6px);border-radius:16px;padding:30px;display:flex;flex-direction:column;gap:20px;height:calc(100% - 120px)}
    .title{font-size:28px;font-weight:700}
    .card{background:rgba(255,255,255,0.05);padding:16px;border-radius:10px;margin-top:8px}
    .footer{position:absolute;bottom:20px;width:100%;text-align:center}
    .hint{display:inline-block;padding:10px 22px;background:linear-gradient(90deg,rgba(6,182,212,0.2),rgba(124,58,237,0.2));border-radius:999px;color:var(--accent);font-weight:600;backdrop-filter:blur(6px)}
    .overlay{position:absolute;inset:0;background:rgba(0,0,0,0.8);backdrop-filter:blur(8px);transform:translateY(100%);transition:transform .4s ease;display:flex;flex-direction:column;padding:20px;overflow:auto}
    .overlay.open{transform:translateY(0)}
    .floor{margin-bottom:20px}
    .floor h2{margin-bottom:10px}
    .rooms{display:flex;gap:10px;flex-wrap:wrap}
    .room{background:rgba(255,255,255,0.1);padding:10px 14px;border-radius:8px;cursor:pointer}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center}
    .modal.show{display:flex}
    .modal-content{background:#111a2b;padding:24px;border-radius:12px;text-align:center}
    .modal-content h3{margin-bottom:10px}
    .modal-content button{margin-top:14px;padding:8px 16px;border:none;border-radius:8px;background:var(--accent);color:#fff;cursor:pointer}
  </style>
</head>
<body>
  <div class="screen">
    <div class="slides" id="slides"></div>
    <div class="footer"><div class="hint" id="hint">menyuga kirish uchun ekranga bosing</div></div>

    <div class="overlay" id="overlay">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
        <h2>üè´ –°—Ö–µ–º–∞ —à–∫–æ–ª—ã</h2>
        <button id="close" style="background:var(--accent);border:none;border-radius:8px;padding:6px 12px;color:#fff;cursor:pointer">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>
      <div id="floors"></div>
    </div>

    <div class="modal" id="modal">
      <div class="modal-content" id="modal-content"></div>
    </div>
  </div>

  <script>
    async function loadData() {
      const res = await fetch('data.json');
      return await res.json();
    }

    function renderSlides(DATA){
      const slides = document.getElementById('slides');
      slides.innerHTML = '';

      slides.appendChild(makeSlide('–õ—É—á—à–∏–π —É—á–µ–Ω–∏–∫ –Ω–µ–¥–µ–ª–∏', `
        <div class="card">
          <div><b>${DATA.best_student_week.name}</b> (${DATA.best_student_week.class})</div>
          <div>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª: ${DATA.best_student_week.score}</div>
        </div>`));

      slides.appendChild(makeSlide('–õ—É—á—à–∏–π –∫–ª–∞—Å—Å –Ω–µ–¥–µ–ª–∏', `
        <div class="card">
          <div><b>${DATA.best_class_week.class}</b></div>
          <div>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª: ${DATA.best_class_week.avg}</div>
        </div>`));

      slides.appendChild(makeSlide('–ù–µ–¥–∞–≤–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è', 
        DATA.recent_events.map(e=>`<div class="card"><b>${e.title}</b><div>${e.date}</div></div>`).join('')
      ));

      slides.appendChild(makeSlide('–õ—É—á—à–∏–µ –∫–ª–∞—Å—Å—ã –∑–∞ –∫–≤–∞—Ä—Ç–∞–ª', 
        DATA.top_classes_quarter.map(c=>`<div class="card"><b>${c.class}</b> ‚Äî ${c.avg}</div>`).join('')
      ));
    }

    function makeSlide(title,content){
      const s=document.createElement('div');
      s.className='slide';
      s.innerHTML=`<div class="slide-inner"><div class="title">${title}</div>${content}</div>`;
      return s;
    }

    function showSlide(i){
      const slides=document.querySelectorAll('.slide');
      slides.forEach((el,idx)=>{el.style.transform=`translateX(${(idx-i)*100}%)`;});
    }

    function renderFloors(DATA){
      const floors=document.getElementById('floors');
      floors.innerHTML='';
      DATA.floors.sort((a,b)=>b.floor-a.floor).forEach(f=>{
        const div=document.createElement('div');
        div.className='floor';
        div.innerHTML=`<h2>–≠—Ç–∞–∂ ${f.floor}</h2>`;
        const rooms=document.createElement('div');
        rooms.className='rooms';
        f.rooms.forEach(r=>{
          const card=document.createElement('div');
          card.className='room';
          card.textContent=`${r.room} ‚Äî ${r.class}`;
          card.onclick=()=>showModal(r);
          rooms.appendChild(card);
        });
        div.appendChild(rooms);
        floors.appendChild(div);
      });
    }

    function showModal(r){
      const modal=document.getElementById('modal');
      const cont=document.getElementById('modal-content');
      cont.innerHTML=`<h3>${r.room} ‚Äî ${r.class}</h3><p>${r.subject}</p><p>–£—á–∏—Ç–µ–ª—å: ${r.teacher}</p><button onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>`;
      modal.classList.add('show');
    }

    function closeModal(){document.getElementById('modal').classList.remove('show');}

    document.getElementById('hint').onclick=()=>document.getElementById('overlay').classList.add('open');
    document.getElementById('close').onclick=()=>document.getElementById('overlay').classList.remove('open');

    (async ()=>{
      const DATA=await loadData();
      renderSlides(DATA);
      renderFloors(DATA);
      showSlide(0);
      let i=0;setInterval(()=>{i=(i+1)%document.querySelectorAll('.slide').length;showSlide(i);},5000);
    })();
  </script>
</body>
</html>
